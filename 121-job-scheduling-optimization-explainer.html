<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>121. Job Scheduling Optimization: Optimizing Cluster Job Scheduling Strategies</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
    --primary-color: #D84315;
    --secondary-color: #E64A19;
    --accent-color: #FF5722;
    --bg-color: #FBE9E7;
    --card-bg: #FFFFFF;
    --text-color: #1A1A1A;
    --border-color: #FFAB91;
    --shadow: 0 2px 8px rgba(216, 67, 21, 0.1);
}
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    line-height: 1.6;
}
header {
    text-align: center;
    padding: 50px 40px;
    background: linear-gradient(135deg, #D84315, #E64A19);
    color: white;
    position: relative;
}
header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 12px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}
.subtitle {
    font-size: 1.2rem;
    opacity: 0.95;
    font-weight: 300;
}
.author-credit {
    font-size: 1rem;
    font-weight: 600;
    margin-top: 15px;
    padding: 8px 20px;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 6px;
    display: inline-block;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    border: 2px solid rgba(255, 255, 255, 0.4);
}

.sidebar-wrapper {
    display: flex;
    min-height: calc(100vh - 200px);
}
.nav-menu {
    width: 280px;
    min-width: 280px;
    background: #80DEEA;
    border-right: 2px solid var(--border-color);
    padding: 20px 0;
    position: sticky;
    top: 0;
    height: calc(100vh - 200px);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 4px;
}
.nav-link {
    color: var(--text-color);
    text-decoration: none;
    padding: 12px 20px;
    margin: 0 10px;
    border-radius: 6px;
    transition: all 0.2s ease;
    font-weight: 500;
    display: block;
}
.nav-link:hover, .nav-link.active {
    background: var(--primary-color);
    color: white;
}
.main-content-wrapper {
    flex: 1;
    width: calc(100% - 280px);
    min-width: 0;
}

.section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
.section h2 {
    font-size: 2.2rem;
    margin-bottom: 20px;
    color: var(--primary-color);
    border-bottom: 3px solid var(--primary-color);
    padding-bottom: 10px;
}
.section h3 {
    font-size: 1.6rem;
    margin: 25px 0 15px;
    color: var(--secondary-color);
}
.section p {
    margin-bottom: 18px;
    font-size: 1.05rem;
    line-height: 1.8;
}
.optimization-card {
    background: var(--card-bg);
    padding: 25px;
    border-radius: 12px;
    border-left: 5px solid var(--primary-color);
    margin: 20px 0;
    box-shadow: var(--shadow);
}
.optimization-card h3 {
    color: var(--primary-color);
    margin-bottom: 15px;
    font-size: 1.4rem;
}
.concept-card {
    background: var(--card-bg);
    padding: 25px;
    border-radius: 12px;
    border: 2px solid var(--border-color);
    margin: 20px 0;
    box-shadow: var(--shadow);
}
.concept-card h3 {
    color: var(--primary-color);
    margin-bottom: 15px;
    font-size: 1.4rem;
}
.mermaid { margin: 30px 0; text-align: center; }
.example-box {
    background: linear-gradient(135deg, #FBE9E7, #FFAB91);
    border-left: 5px solid var(--primary-color);
    padding: 20px 25px;
    margin: 20px 0;
    border-radius: 8px;
}
.example-box strong {
    color: var(--primary-color);
    display: block;
    margin-bottom: 10px;
    font-size: 1.1rem;
}
code {
    background: #F5F5F5;
    padding: 2px 8px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    color: #D32F2F;
}
.command-box {
    background: #263238;
    color: #FF5722;
    padding: 20px;
    border-radius: 8px;
    margin: 15px 0;
    font-family: 'Courier New', monospace;
    overflow-x: auto;
}
footer {
    text-align: center;
    padding: 40px;
    background: #FFAB91;
    border-top: 2px solid var(--border-color);
    color: var(--text-color);
}
@media (max-width: 768px) {
    header h1 { font-size: 2rem; }
    
    .nav-menu {
        width: 100%;
        min-width: 100%;
        height: auto;
        position: relative;
        flex-direction: row;
        flex-wrap: wrap;
        padding: 10px;
        border-right: none;
        border-bottom: 2px solid var(--border-color);
    }
    .nav-link {
        padding: 8px 15px;
        margin: 4px;
    }
    
    .section { padding: 25px 20px; }
}
    .section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
    </style>
</head>
<body>
    <header>
        <h1>121. Job Scheduling Optimization</h1>
        <p class="subtitle">Optimizing Cluster Job Scheduling Strategies</p>
        <p class="author-credit">Explained by Naman Adep</p>
    </header>

    <div class="sidebar-wrapper">
    <nav class="nav-menu">
        <a href="#overview" class="nav-link active">Overview</a>
        <a href="#queue-management" class="nav-link">Queue Management</a>
        <a href="#priority-policies" class="nav-link">Priority Policies</a>
        <a href="#fair-share" class="nav-link">Fair-Share Scheduling</a>
        <a href="#backfill" class="nav-link">Backfill Scheduling</a>
        <a href="#optimization" class="nav-link">Optimization Strategies</a>
        <a href="#best-practices" class="nav-link">Best Practices</a>
    </nav>
    <div class="main-content-wrapper">
        <main>
        <section id="overview" class="section">
            <h2>Job Scheduling Optimization Overview</h2>
            <p>
                Job scheduling optimization improves cluster utilization, reduces job wait times, and ensures fair 
                resource allocation. Effective scheduling strategies balance user needs, resource availability, and 
                cluster efficiency. Optimization includes queue management, priority policies, fair-share scheduling, 
                and backfill strategies. Understanding scheduling optimization enables efficient cluster resource 
                utilization and improved user experience.
            </p>

            <div class="mermaid">
                graph TD
                    A[Job Scheduling Optimization] --> B[Queue Management]
                    A --> C[Priority Policies]
                    A --> D[Fair-Share Scheduling]
                    A --> E[Backfill Scheduling]
                    B --> F[Partition Configuration]
                    B --> G[QOS Management]
                    C --> H[Priority Calculation]
                    C --> I[Preemption]
                    D --> J[Usage Tracking]
                    D --> K[Fairness Enforcement]
                    E --> L[Gap Filling]
                    E --> M[Resource Utilization]
                    
                    style A fill:#D84315
                    style B fill:#E64A19
                    style C fill:#FF5722
            </div>

            <div class="example-box">
                <strong>Scheduling Optimization Impact:</strong>
                Effective scheduling optimization can improve cluster utilization from 60% to 85%+, reduce average job 
                wait time by 40-60%, and improve user satisfaction through fair resource allocation. Proper queue 
                management and priority policies ensure critical workloads get resources while maintaining fairness.
            </div>

            <div class="mermaid">
                mindmap
                  root((Job Scheduling Optimization))
                    Queue Management
                      Partition Configuration
                      QOS Management
                      Queue Policies
                    Priority Policies
                      Priority Calculation
                      Preemption
                      Priority Boost
                    Fair-Share Scheduling
                      Usage Tracking
                      Fairness Enforcement
                      Decay Factors
                    Backfill Scheduling
                      Gap Filling
                      Resource Utilization
                      Backfill Algorithms
            </div>
        </section>

        <section id="queue-management" class="section">
            <h2>Queue Management</h2>
            <p>
                Effective queue management organizes jobs into logical groups, enabling better resource allocation and 
                workload management. Queue management includes partition configuration, QOS management, and queue policies.
            </p>

            <div class="optimization-card">
                <h3>Partition Strategy</h3>
                <p>Design partitions for optimal resource allocation:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Resource-Based Partitions:</strong> Separate partitions for GPU, CPU, high-memory nodes</li>
                    <li><strong>Time-Based Partitions:</strong> Short, medium, long partitions for different job durations</li>
                    <li><strong>User-Based Partitions:</strong> Dedicated partitions for specific user groups</li>
                    <li><strong>Priority Partitions:</strong> High-priority partitions for urgent workloads</li>
                </ul>

                <p style="margin-top: 20px;"><strong>SLURM Partition Configuration:</strong></p>
                <div class="command-box">
# GPU Partition - Short jobs (max 4 hours)
PartitionName=gpu-short \
    Nodes=gpu-node[1-20] \
    Default=NO \
    MaxTime=4:00:00 \
    Priority=100

# GPU Partition - Long jobs (max 7 days)
PartitionName=gpu-long \
    Nodes=gpu-node[1-20] \
    Default=YES \
    MaxTime=7-00:00:00 \
    Priority=50

# High-Priority Partition
PartitionName=gpu-priority \
    Nodes=gpu-node[21-25] \
    Default=NO \
    MaxTime=1-00:00:00 \
    Priority=200
                </div>
            </div>

            <div class="optimization-card">
                <h3>QOS Management</h3>
                <p>Configure Quality of Service levels for resource control:</p>
                
                <p style="margin-top: 20px;"><strong>QOS Configuration:</strong></p>
                <div class="command-box">
# High Priority QOS
QOSName=high \
    Priority=100 \
    MaxWall=3-00:00:00 \
    MaxJobs=10 \
    MaxTRES=cpu=256,mem=512000,gres/gpu=16

# Normal QOS
QOSName=normal \
    Priority=50 \
    MaxWall=7-00:00:00 \
    MaxJobs=100 \
    MaxTRES=cpu=1024,mem=2048000,gres/gpu=64

# Low Priority QOS (Preemptible)
QOSName=low \
    Priority=10 \
    MaxWall=30-00:00:00 \
    MaxJobs=1000 \
    PreemptMode=REQUEUE
                </div>
            </div>
        </section>

        <section id="priority-policies" class="section">
            <h2>Priority Policies</h2>
            <p>
                Priority policies determine job execution order based on various factors. Effective priority policies 
                balance user needs, resource availability, and fairness.
            </p>

            <div class="concept-card">
                <h3>Priority Calculation</h3>
                <p>SLURM calculates job priority based on multiple factors:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Age:</strong> Older jobs get higher priority</li>
                    <li><strong>Fair-Share:</strong> Users with lower usage get higher priority</li>
                    <li><strong>Partition Priority:</strong> Partition priority affects job priority</li>
                    <li><strong>QOS Priority:</strong> QOS priority contributes to job priority</li>
                    <li><strong>Job Size:</strong> Smaller jobs may get priority boost</li>
                </ul>

                <p style="margin-top: 20px;"><strong>Priority Calculation Formula:</strong></p>
                <div class="command-box">
# Priority = Age + FairShare + PartitionPriority + QOSPriority + JobSizeFactor

# Configure priority weight factors in slurm.conf
PriorityType=priority/multifactor
PriorityWeightAge=1000
PriorityWeightFairshare=10000
PriorityWeightPartition=1000
PriorityWeightQOS=1000
PriorityWeightJobSize=1000
                </div>
            </div>

            <div class="concept-card">
                <h3>Preemption</h3>
                <p>Configure preemption for better resource utilization:</p>
                
                <p style="margin-top: 20px;"><strong>Preemption Configuration:</strong></p>
                <div class="command-box">
# Enable preemption in slurm.conf
PreemptType=preempt/partition_prio
PreemptMode=REQUEUE

# Configure preemptable partitions
PartitionName=low-priority \
    Nodes=node[51-100] \
    PreemptMode=REQUEUE \
    PreemptExemptTime=00:05:00
                </div>

                <p style="margin-top: 20px;"><strong>Preemption Benefits:</strong></p>
                <ul style="margin-top: 10px; padding-left: 20px; line-height: 2;">
                    <li>High-priority jobs can start immediately</li>
                    <li>Low-priority jobs are requeued</li>
                    <li>Improves resource utilization</li>
                    <li>Reduces wait time for urgent jobs</li>
                </ul>
            </div>

            <div class="mermaid">
                flowchart TD
                    A[Job Submitted] --> B[Calculate Priority]
                    B --> C{Age Factor}
                    B --> D[Fair-Share Factor]
                    B --> E[Partition Priority]
                    B --> F[QOS Priority]
                    C --> G[Total Priority]
                    D --> G
                    E --> G
                    F --> G
                    G --> H{Resources Available?}
                    H -->|Yes| I[Start Job]
                    H -->|No| J{Preempt Lower Priority?}
                    J -->|Yes| K[Preempt Job]
                    K --> I
                    J -->|No| L[Wait in Queue]
                    L --> B
                    
                    style A fill:#D84315
                    style I fill:#4CAF50
                    style H fill:#FF9800
                    style J fill:#FF9800
            </div>
        </section>

        <section id="fair-share" class="section">
            <h2>Fair-Share Scheduling</h2>
            <p>
                Fair-share scheduling ensures equitable resource allocation among users and accounts. Fair-share tracks 
                resource usage and adjusts priorities to maintain fairness over time.
            </p>

            <div class="optimization-card">
                <h3>Fair-Share Configuration</h3>
                <p>Configure fair-share scheduling in SLURM:</p>
                
                <p style="margin-top: 20px;"><strong>Fair-Share Settings:</strong></p>
                <div class="command-box">
# Enable fair-share in slurm.conf
PriorityType=priority/multifactor
PriorityWeightFairshare=10000

# Configure fair-share decay (half-life)
FairshareDampeningFactor=1

# Set account hierarchy
AccountingStorageEnforce=associations
AccountingStorageType=accounting_storage/slurmdbd
                </div>

                <p style="margin-top: 20px;"><strong>Fair-Share Calculation:</strong></p>
                <ul style="margin-top: 10px; padding-left: 20px; line-height: 2;">
                    <li>Tracks resource usage per user/account</li>
                    <li>Compares usage to allocated share</li>
                    <li>Adjusts priority based on usage ratio</li>
                    <li>Applies decay factor over time</li>
                </ul>
            </div>

            <div class="optimization-card">
                <h3>Usage Tracking</h3>
                <p>Track resource usage for fair-share calculation:</p>
                
                <p style="margin-top: 20px;"><strong>View Fair-Share Information:</strong></p>
                <div class="command-box">
# View user fair-share information
sshare -u [username]

# View account fair-share information
sshare -a [account]

# View detailed fair-share
sshare -l -u [username]
                </div>
            </div>
        </section>

        <section id="backfill" class="section">
            <h2>Backfill Scheduling</h2>
            <p>
                Backfill scheduling improves resource utilization by filling gaps in the schedule with smaller jobs. 
                Backfill allows lower-priority jobs to run when resources are available, improving overall cluster 
                efficiency.
            </p>

            <div class="concept-card">
                <h3>Backfill Configuration</h3>
                <p>Configure backfill scheduling in SLURM:</p>
                
                <p style="margin-top: 20px;"><strong>Backfill Settings:</strong></p>
                <div class="command-box">
# Enable backfill scheduler in slurm.conf
SchedulerType=sched/backfill

# Configure backfill parameters
SchedulerParameters=bf_interval=30,bf_max_job_test=1000,bf_window=3600

# Parameters explained:
# bf_interval: How often to run backfill (seconds)
# bf_max_job_test: Maximum jobs to test for backfill
# bf_window: Time window for backfill (seconds)
                </div>
            </div>

            <div class="concept-card">
                <h3>Backfill Benefits</h3>
                <p>Backfill scheduling provides several benefits:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Improved Utilization:</strong> Fills gaps in schedule</li>
                    <li><strong>Reduced Wait Time:</strong> Smaller jobs start sooner</li>
                    <li><strong>Better Throughput:</strong> More jobs complete per day</li>
                    <li><strong>Fairness:</strong> Doesn't affect high-priority jobs</li>
                </ul>
            </div>

            <div class="mermaid">
                sequenceDiagram
                    participant Queue
                    participant Scheduler
                    participant HighPriority
                    participant Backfill
                    participant Resources

                    Queue->>Scheduler: Job Queue
                    Scheduler->>HighPriority: Check High Priority Jobs
                    HighPriority->>Resources: Reserve Resources
                    Scheduler->>Backfill: Check Gaps
                    Backfill->>Resources: Fill Gaps with Small Jobs
                    Resources->>Backfill: Execute Backfill Jobs
                    HighPriority->>Resources: High Priority Job Ready
                    Resources->>Backfill: Preempt if Needed
                    Resources->>HighPriority: Execute High Priority Job
            </div>
        </section>

        <section id="optimization" class="section">
            <h2>Scheduling Optimization Strategies</h2>
            <p>
                Implement optimization strategies to improve scheduling efficiency and cluster utilization.
            </p>

            <div class="optimization-card">
                <h3>Job Batching</h3>
                <p>Batch similar jobs to improve efficiency:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Array Jobs:</strong> Use job arrays for similar jobs</li>
                    <li><strong>Job Packing:</strong> Pack multiple small jobs on same node</li>
                    <li><strong>Resource Consolidation:</strong> Consolidate jobs to maximize utilization</li>
                </ul>

                <p style="margin-top: 20px;"><strong>Array Job Example:</strong></p>
                <div class="command-box">
#!/bin/bash
#SBATCH --job-name=array_job
#SBATCH --array=1-100
#SBATCH --partition=gpu
#SBATCH --gres=gpu:1

# Process array index
python train.py --config config_${SLURM_ARRAY_TASK_ID}.yaml
                </div>
            </div>

            <div class="optimization-card">
                <h3>Resource Reservation</h3>
                <p>Use reservations for guaranteed resource access:</p>
                
                <p style="margin-top: 20px;"><strong>Create Reservation:</strong></p>
                <div class="command-box">
# Create reservation for specific time
scontrol create reservation \
    ReservationName=training_slot \
    StartTime=2024-01-15T09:00:00 \
    Duration=24:00:00 \
    Nodes=gpu-node[1-10] \
    Users=user1,user2

# Submit job to reservation
sbatch --reservation=training_slot job.sh
                </div>
            </div>
        </section>

        <section id="best-practices" class="section">
            <h2>Scheduling Optimization Best Practices</h2>
            <p>
                Follow best practices for effective job scheduling optimization.
            </p>

            <div class="concept-card">
                <h3>Configuration Best Practices</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li>Design partitions based on workload characteristics</li>
                    <li>Configure QOS levels for resource control</li>
                    <li>Enable fair-share for equitable resource allocation</li>
                    <li>Enable backfill for improved utilization</li>
                    <li>Set appropriate priority weights</li>
                    <li>Configure preemption for high-priority jobs</li>
                </ul>
            </div>

            <div class="concept-card">
                <h3>Monitoring Best Practices</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li>Monitor queue wait times</li>
                    <li>Track resource utilization</li>
                    <li>Monitor fair-share usage</li>
                    <li>Analyze scheduling efficiency</li>
                    <li>Review priority distributions</li>
                </ul>
            </div>

            <div class="example-box">
                <strong>Scheduling Optimization Checklist:</strong>
                1. Design partition strategy<br>
                2. Configure QOS levels<br>
                3. Enable fair-share scheduling<br>
                4. Configure backfill scheduling<br>
                5. Set priority weights<br>
                6. Configure preemption<br>
                7. Monitor scheduling metrics<br>
                8. Optimize based on metrics<br>
                9. Document scheduling policies<br>
                10. Review and adjust regularly
            </div>
        </section>
            </main>

            </div>
</div>

    <footer>
        <p>Job Scheduling Optimization | Optimizing Cluster Job Scheduling Strategies</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
        
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetSection = document.querySelector(targetId);
                
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' }
);
            });
        });

        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section');
            const navLinks = document.querySelectorAll('.nav-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }

            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
