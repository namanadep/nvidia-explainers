<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GPU Memory Hierarchy: Understanding Memory Architecture and Access Patterns</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
    --primary-color: #0288D1;
    --secondary-color: #03A9F4;
    --accent-color: #4FC3F7;
    --bg-color: #E1F5FE;
    --card-bg: #FFFFFF;
    --text-color: #1A1A1A;
    --border-color: #81D4FA;
    --shadow: 0 2px 8px rgba(2, 136, 209, 0.1);
}
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    line-height: 1.6;
}
header {
    text-align: center;
    padding: 50px 40px;
    background: linear-gradient(135deg, #0288D1, #03A9F4);
    color: white;
    position: relative;
}
header::before {
    content: '';
    position: absolute;
    font-size: 200px;
    opacity: 0.1;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    animation: flow 3s ease-in-out infinite;
}
@keyframes flow {
    0%, 100% { transform: translate(-50%, -50%) translateY(0); }
    50% { transform: translate(-50%, -50%) translateY(-10px); }
}
header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 12px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}
.sidebar-wrapper {
    display: flex;
    min-height: calc(100vh - 200px);
}
.nav-menu {
    width: 280px;
    min-width: 280px;
    background: #80DEEA;
    border-right: 2px solid var(--border-color);
    padding: 20px 0;
    position: sticky;
    top: 0;
    height: calc(100vh - 200px);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 4px;
}
.nav-link {
    color: var(--text-color);
    text-decoration: none;
    padding: 12px 20px;
    margin: 0 10px;
    border-radius: 6px;
    transition: all 0.2s ease;
    font-weight: 500;
    display: block;
}
.nav-link:hover, .nav-link.active {
    background: var(--primary-color);
    color: white;
}
.main-content-wrapper {
    flex: 1;
    width: calc(100% - 280px);
    min-width: 0;
}

.section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
.section h2 {
    font-size: 2.2rem;
    margin-bottom: 20px;
    color: var(--primary-color);
    border-bottom: 3px solid var(--primary-color);
    padding-bottom: 10px;
}
.water-card {
    background: var(--card-bg);
    padding: 25px;
    border-radius: 12px;
    border: 2px solid var(--border-color);
    margin: 20px 0;
    box-shadow: var(--shadow);
}
.mermaid { margin: 30px 0; text-align: center; }
.example-box {
    background: linear-gradient(135deg, #E1F5FE, #81D4FA);
    border-left: 5px solid var(--primary-color);
    padding: 20px 25px;
    margin: 20px 0;
    border-radius: 8px;
}
footer {
    text-align: center;
    padding: 40px;
    background: #81D4FA;
    border-top: 2px solid var(--border-color);
    color: var(--text-color);
}
@media (max-width: 768px) {
    header h1 { font-size: 2rem; }
    
    .nav-menu {
        width: 100%;
        min-width: 100%;
        height: auto;
        position: relative;
        flex-direction: row;
        flex-wrap: wrap;
        padding: 10px;
        border-right: none;
        border-bottom: 2px solid var(--border-color);
    }
    .nav-link {
        padding: 8px 15px;
        margin: 4px;
    }
    
    .section { padding: 25px 20px; }
}
    .section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
    
.author-credit {
    font-size: 1rem;
    font-weight: 600;
    margin-top: 15px;
    padding: 8px 20px;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 6px;
    display: inline-block;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    border: 2px solid rgba(255, 255, 255, 0.4);
}
</style>
</head>
<body>
    <header>
        <h1>17. GPU Memory Hierarchy</h1>
        <p class="subtitle">Understanding Memory Architecture and Access Patterns</p>
        <p class="author-credit">Explained by Naman Adep</p>
    </header>

    <div class="sidebar-wrapper">
    <nav class="nav-menu">
        <a href="#overview" class="nav-link active">Overview</a>
        <a href="#global-memory" class="nav-link">Global Memory</a>
        <a href="#shared-memory" class="nav-link">Shared Memory</a>
        <a href="#bandwidth" class="nav-link">Memory Bandwidth</a>
        <a href="#registers" class="nav-link">Registers</a>
        <a href="#optimization" class="nav-link">Optimization</a>
    </nav>
    <div class="main-content-wrapper">
        <main>
        <section id="overview" class="section">
            <h2>GPU Memory Hierarchy Overview</h2>
            <p>
                GPUs employ a hierarchical memory architecture with multiple tiers, each offering different 
                capacity, latency, and bandwidth characteristics. Understanding this hierarchy is essential 
                for optimizing GPU applications, as data placement and access patterns significantly impact 
                performance. The hierarchy ranges from large, slower global memory to small, ultra-fast 
                registers, with shared memory providing a middle ground.
            </p>
        </section>

        <section id="global-memory" class="section">
            <h2>Global Memory</h2>
            <p>
                Global memory is the largest memory tier in the GPU hierarchy, providing gigabytes of storage 
                capacity. It serves as the primary storage location for data structures, model weights, and 
                intermediate results. While global memory offers substantial capacity, it has higher latency 
                and lower bandwidth compared to other memory tiers, making efficient access patterns critical 
                for performance.
            </p>

            <div class="mermaid">
                graph TD
                    A[Global Memory<br/>Reservoir] --> B[Large Capacity<br/>GBs of Storage]
                    A --> C[Slower Access<br/>Higher Latency]
                    A --> D[Main Storage<br/>Where Data Lives]
                    
                    style A fill:#0288D1
                    style B fill:#03A9F4
                    style C fill:#4FC3F7
                    style D fill:#81D4FA
            </div>

            <div class="mermaid">
                graph TB
                    A[GPU Memory Hierarchy] --> B[Global Memory<br/>Large, Slow]
                    A --> C[Shared Memory<br/>Medium, Fast]
                    A --> D[Registers<br/>Small, Very Fast]
                    
                    B --> E[GBs Capacity<br/>~100-1000 GB/s Bandwidth]
                    C --> F[KBs Capacity<br/>~1000-10000 GB/s Bandwidth]
                    D --> G[Bytes Capacity<br/>Ultra-fast Access]
                    
                    style A fill:#0288D1
                    style B fill:#03A9F4
                    style C fill:#4FC3F7
                    style D fill:#81D4FA
            </div>

            <div class="example-box">
                <strong>Memory Hierarchy Characteristics:</strong>
                Global memory stores large amounts of data (GBs) but has higher latency compared to 
                faster memory tiers. It serves as the primary storage location for GPU data structures, 
                model weights, and intermediate results. While it offers substantial capacity, access 
                times are longer than shared memory or registers.
            </div>

            <div class="mermaid">
                mindmap
                  root((GPU Memory Hierarchy))
                    Global Memory
                      Large Capacity
                        GBs Storage
                        Model Weights
                      Higher Latency
                        ~400 cycles
                        Primary Storage
                      Bandwidth
                        ~100-1000 GB/s
                    Shared Memory
                      Medium Capacity
                        KBs per Block
                        Thread Block Sharing
                      Faster Access
                        ~20 cycles
                        Data Sharing
                      Bandwidth
                        ~1000-10000 GB/s
                    Registers
                      Small Capacity
                        Bytes per Thread
                        Local Variables
                      Ultra-Fast Access
                        ~1 cycle
                        Fastest Tier
            </div>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Memory Type</th>
                        <th>Capacity</th>
                        <th>Bandwidth</th>
                        <th>Latency</th>
                        <th>Use Case</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Global Memory</strong></td>
                        <td>GBs (e.g., 80GB H100)</td>
                        <td>~100-1000 GB/s</td>
                        <td>High (~400 cycles)</td>
                        <td>Model weights, large datasets</td>
                    </tr>
                    <tr>
                        <td><strong>Shared Memory</strong></td>
                        <td>KBs per block (e.g., 48KB)</td>
                        <td>~1000-10000 GB/s</td>
                        <td>Medium (~20 cycles)</td>
                        <td>Thread block data sharing</td>
                    </tr>
                    <tr>
                        <td><strong>Registers</strong></td>
                        <td>Bytes per thread (e.g., 64KB)</td>
                        <td>Ultra-fast</td>
                        <td>Low (~1 cycle)</td>
                        <td>Local variables, fast access</td>
                    </tr>
                </tbody>
            </table>
        </section>

        <section id="shared-memory" class="section">
            <h2>Shared Memory</h2>
            <p>
                Shared memory provides medium-capacity storage with faster access than global memory. 
                It's shared among threads in a thread block, enabling efficient data sharing and 
                reducing global memory access.
            </p>

            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin: 30px 0;">
                <div class="water-card" style="border-left: 5px solid #0288D1;">
                    <h3 style="color: #0288D1; margin-bottom: 15px;">Global Memory</h3>
                    <p><strong>Characteristics:</strong></p>
                    <ul style="margin-top: 10px; padding-left: 20px; line-height: 1.8;">
                        <li>Large capacity (GBs)</li>
                        <li>Higher latency</li>
                        <li>Primary storage</li>
                    </ul>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                        Stores model weights, datasets, and large data structures.
                    </p>
                </div>

                <div class="water-card" style="border-left: 5px solid #03A9F4;">
                    <h3 style="color: #03A9F4; margin-bottom: 15px;">Shared Memory</h3>
                    <p><strong>Characteristics:</strong></p>
                    <ul style="margin-top: 10px; padding-left: 20px; line-height: 1.8;">
                        <li>Faster access</li>
                        <li>Medium capacity (KBs)</li>
                        <li>Shared by threads</li>
                    </ul>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                        Enables efficient data sharing within thread blocks.
                    </p>
                </div>

                <div class="water-card" style="border-left: 5px solid #4FC3F7;">
                    <h3 style="color: #4FC3F7; margin-bottom: 15px;">Registers</h3>
                    <p><strong>Characteristics:</strong></p>
                    <ul style="margin-top: 10px; padding-left: 20px; line-height: 1.8;">
                        <li>Ultra-fast access</li>
                        <li>Small capacity (bytes)</li>
                        <li>Per-thread storage</li>
                    </ul>
                    <p style="margin-top: 15px; font-size: 0.9rem; color: #666;">
                        Fastest memory tier for local variables and computations.
                    </p>
                </div>
            </div>

            <div class="mermaid">
                flowchart TD
                    A[GPU Memory Access] --> B{Data Size?}
                    B -->|Small, Frequent| C[Registers<br/>Ultra-Fast]
                    B -->|Block Shared| D[Shared Memory<br/>Fast]
                    B -->|Large Data| E[Global Memory<br/>Slower]
                    
                    C --> F[Execute Operation]
                    D --> F
                    E --> F
                    
                    style C fill:#81D4FA
                    style D fill:#4FC3F7
                    style E fill:#03A9F4
            </div>

            <div class="water-card">
                <h3>Shared Memory Characteristics</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Faster Access:</strong> Lower latency than global memory</li>
                    <li><strong>Medium Capacity:</strong> KBs to MBs per block</li>
                    <li><strong>Shared:</strong> Accessible by all threads in a block</li>
                    <li><strong>Efficient:</strong> Reduces global memory traffic</li>
                </ul>
            </div>
        </section>

        <section id="bandwidth" class="section">
            <h2>Memory Bandwidth</h2>
            <p>
                Memory bandwidth determines how fast data can be transferred between memory and compute units. 
                Higher bandwidth enables faster data access, which is critical for GPU performance. GPUs use 
                high-bandwidth memory (HBM) to achieve terabyte-per-second transfer rates.
            </p>

            <div class="mermaid">
                graph TB
                    A[Memory Bandwidth] --> B[High Bandwidth<br/>HBM Technology]
                    A --> C[Low Bandwidth<br/>Standard Memory]
                    B --> D[Fast Transfer<br/>Terabytes/sec]
                    C --> E[Slower Transfer<br/>Gigabytes/sec]
                    
                    D --> F[GPU Performance]
                    E --> F
                    
                    style B fill:#03A9F4
                    style D fill:#4FC3F7
            </div>

            <div class="mermaid">
                flowchart TD
                    A[GPU Compute Unit] --> B{Need Data}
                    B -->|Frequent Access| C[Registers<br/>Ultra-Fast]
                    B -->|Block Shared| D[Shared Memory<br/>Fast]
                    B -->|Large Data| E[Global Memory<br/>Slower]
                    
                    C --> F[Execute Operation]
                    D --> F
                    E --> F
                    
                    style C fill:#4FC3F7
                    style D fill:#03A9F4
                    style E fill:#0288D1
            </div>

            <div class="example-box">
                <strong>Bandwidth Impact:</strong>
                Higher memory bandwidth enables faster data transfer between memory and compute units. 
                GPU memory technologies like HBM (High Bandwidth Memory) provide terabyte-per-second 
                bandwidth, enabling high-performance data access. This bandwidth is essential for 
                feeding data to thousands of parallel compute cores efficiently.
            </div>
        </section>

        <section id="registers" class="section">
            <h2>Registers</h2>
            <p>
                Registers provide the fastest memory access with zero latency. They have small capacity 
                but are directly accessible by compute units, making them ideal for frequently accessed 
                variables and intermediate calculations.
            </p>

            <div class="water-card">
                <h3>Register Characteristics</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Instant Access:</strong> Zero latency, fastest memory tier</li>
                    <li><strong>Small Capacity:</strong> Limited to KBs per thread</li>
                    <li><strong>Local:</strong> Directly accessible by compute units</li>
                    <li><strong>Fastest:</strong> Highest performance memory tier</li>
                </ul>
            </div>
        </section>

        <section id="pressure" class="section">
            <h2>âš¡ The Pressure: Bandwidth</h2>
            <p>
                Bandwidth is like water pressure - how fast water (data) flows through the system. 
                Higher pressure means faster flow, higher bandwidth means faster data movement.
            </p>

            <div class="mermaid">
                graph TD
                    A[Bandwidth<br/>Pressure] --> B[High Pressure<br/>High Bandwidth]
                    A --> C[Low Pressure<br/>Low Bandwidth]
                    B --> D[Fast Data Flow<br/>Terabytes/sec]
                    C --> E[Slow Data Flow<br/>Gigabytes/sec]
                    
                    style A fill:#0288D1
                    style B fill:#03A9F4
                    style D fill:#4FC3F7
            </div>
        </section>

        <section id="plumbing" class="section">
            <h2>ðŸ”§ Optimal Plumbing: Efficient Memory Use</h2>
            <p>
                Efficient memory use is like optimal plumbing - data flows smoothly from reservoir 
                (global memory) through pipes (bandwidth) to water towers (shared memory) to faucets 
                (registers).
            </p>

            <div class="mermaid">
                graph TD
                    A[Reservoir<br/>Global Memory] -->|Pipes<br/>Bandwidth| B[Water Towers<br/>Shared Memory]
                    B -->|Local Pipes<br/>Fast Access| C[Faucets<br/>Registers]
                    C --> D[Applications<br/>Use Data]
                    
                    style A fill:#0288D1
                    style B fill:#03A9F4
                    style C fill:#4FC3F7
                    style D fill:#81D4FA
            </div>

            <div class="example-box">
                <strong>ðŸ”§ Optimal Plumbing:</strong>
                Optimal memory hierarchy design ensures data flows efficiently from global memory to registers, 
                minimizing latency and maximizing bandwidth utilization. Understanding the memory hierarchy helps 
                optimize data placement, access patterns, and memory usage for maximum GPU performance.
            </div>
        </section>
            </main>

            </div>
</div>

    <footer>
        <p><strong>GPU Memory Hierarchy</strong> - Understanding Memory Architecture</p>
        <p>Memory hierarchy: global memory, shared memory, and registers</p>
    </footer>

    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                document.querySelector(this.getAttribute('href')).scrollIntoView({ behavior: 'smooth' }
);
            });
        });
        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section');
            const navLinks = document.querySelectorAll('.nav-link');
            let current = '';
            sections.forEach(s => {
                if (window.pageYOffset >= s.offsetTop - 100) current = s.getAttribute('id');
            }
);
            navLinks.forEach(l => {
                l.classList.remove('active');
                if (l.getAttribute('href') === `#${current}`) l.classList.add('active');
            });
        });
    </script>
</body>
</html>
