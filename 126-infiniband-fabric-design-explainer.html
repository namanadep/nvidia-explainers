<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>126. InfiniBand Fabric Design: Designing High-Performance InfiniBand Networks</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
    --primary-color: #0D47A1;
    --secondary-color: #1565C0;
    --accent-color: #1976D2;
    --bg-color: #E3F2FD;
    --card-bg: #FFFFFF;
    --text-color: #1A1A1A;
    --border-color: #90CAF9;
    --shadow: 0 2px 8px rgba(13, 71, 161, 0.1);
}
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    line-height: 1.6;
}
header {
    text-align: center;
    padding: 50px 40px;
    background: linear-gradient(135deg, #0D47A1, #1565C0);
    color: white;
    position: relative;
}
header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 12px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}
.subtitle {
    font-size: 1.2rem;
    opacity: 0.95;
    font-weight: 300;
}
.author-credit {
    font-size: 1rem;
    font-weight: 600;
    margin-top: 15px;
    padding: 8px 20px;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 6px;
    display: inline-block;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    border: 2px solid rgba(255, 255, 255, 0.4);
}

.sidebar-wrapper {
    display: flex;
    min-height: calc(100vh - 200px);
}
.nav-menu {
    width: 280px;
    min-width: 280px;
    background: #80DEEA;
    border-right: 2px solid var(--border-color);
    padding: 20px 0;
    position: sticky;
    top: 0;
    height: calc(100vh - 200px);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 4px;
}
.nav-link {
    color: var(--text-color);
    text-decoration: none;
    padding: 12px 20px;
    margin: 0 10px;
    border-radius: 6px;
    transition: all 0.2s ease;
    font-weight: 500;
    display: block;
}
.nav-link:hover, .nav-link.active {
    background: var(--primary-color);
    color: white;
}
.main-content-wrapper {
    flex: 1;
    width: calc(100% - 280px);
    min-width: 0;
}

.section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
.section h2 {
    font-size: 2.2rem;
    margin-bottom: 20px;
    color: var(--primary-color);
    border-bottom: 3px solid var(--primary-color);
    padding-bottom: 10px;
}
.section h3 {
    font-size: 1.6rem;
    margin: 25px 0 15px;
    color: var(--secondary-color);
}
.section p {
    margin-bottom: 18px;
    font-size: 1.05rem;
    line-height: 1.8;
}
.design-card {
    background: var(--card-bg);
    padding: 25px;
    border-radius: 12px;
    border-left: 5px solid var(--primary-color);
    margin: 20px 0;
    box-shadow: var(--shadow);
}
.design-card h3 {
    color: var(--primary-color);
    margin-bottom: 15px;
    font-size: 1.4rem;
}
.concept-card {
    background: var(--card-bg);
    padding: 25px;
    border-radius: 12px;
    border: 2px solid var(--border-color);
    margin: 20px 0;
    box-shadow: var(--shadow);
}
.concept-card h3 {
    color: var(--primary-color);
    margin-bottom: 15px;
    font-size: 1.4rem;
}
.mermaid { margin: 30px 0; text-align: center; }
.example-box {
    background: linear-gradient(135deg, #E3F2FD, #90CAF9);
    border-left: 5px solid var(--primary-color);
    padding: 20px 25px;
    margin: 20px 0;
    border-radius: 8px;
}
.example-box strong {
    color: var(--primary-color);
    display: block;
    margin-bottom: 10px;
    font-size: 1.1rem;
}
code {
    background: #F5F5F5;
    padding: 2px 8px;
    border-radius: 4px;
    font-family: 'Courier New', monospace;
    color: #D32F2F;
}
.command-box {
    background: #263238;
    color: #1976D2;
    padding: 20px;
    border-radius: 8px;
    margin: 15px 0;
    font-family: 'Courier New', monospace;
    overflow-x: auto;
}
footer {
    text-align: center;
    padding: 40px;
    background: #90CAF9;
    border-top: 2px solid var(--border-color);
    color: var(--text-color);
}
@media (max-width: 768px) {
    header h1 { font-size: 2rem; }
    
    .nav-menu {
        width: 100%;
        min-width: 100%;
        height: auto;
        position: relative;
        flex-direction: row;
        flex-wrap: wrap;
        padding: 10px;
        border-right: none;
        border-bottom: 2px solid var(--border-color);
    }
    .nav-link {
        padding: 8px 15px;
        margin: 4px;
    }
    
    .section { padding: 25px 20px; }
}
    .section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
    </style>
</head>
<body>
    <header>
        <h1>126. InfiniBand Fabric Design</h1>
        <p class="subtitle">Designing High-Performance InfiniBand Networks</p>
        <p class="author-credit">Explained by Naman Adep</p>
    </header>

    <div class="sidebar-wrapper">
    <nav class="nav-menu">
        <a href="#overview" class="nav-link active">Overview</a>
        <a href="#topology-design" class="nav-link">Topology Design</a>
        <a href="#switch-placement" class="nav-link">Switch Placement</a>
        <a href="#routing-optimization" class="nav-link">Routing</a>
        <a href="#scalability" class="nav-link">Scalability</a>
        <a href="#best-practices" class="nav-link">Best Practices</a>
    </nav>
    <div class="main-content-wrapper">
        <main>
        <section id="overview" class="section">
            <h2>InfiniBand Fabric Design Overview</h2>
            <p>
                InfiniBand fabric design involves planning network topology, switch placement, routing, and scalability 
                for high-performance AI clusters. Proper fabric design ensures optimal bandwidth, low latency, and 
                scalability. Design considerations include topology selection, switch placement, routing optimization, 
                and growth planning. Understanding fabric design enables creation of efficient InfiniBand networks 
                that meet performance and scalability requirements.
            </p>

            <div class="mermaid">
                graph TD
                    A[InfiniBand Fabric Design] --> B[Topology Selection]
                    A --> C[Switch Placement]
                    A --> D[Routing Design]
                    A --> E[Scalability Planning]
                    B --> F[Fat-Tree]
                    B --> G[Torus]
                    B --> H[Dragonfly+]
                    C --> I[Leaf Switches]
                    C --> J[Spine Switches]
                    D --> K[LID Assignment]
                    D --> L[Routing Tables]
                    E --> M[Growth Planning]
                    E --> N[Upgrade Paths]
                    
                    style A fill:#0D47A1
                    style B fill:#1565C0
                    style D fill:#1976D2
            </div>

            <div class="example-box">
                <strong>Fabric Design Impact:</strong>
                Proper InfiniBand fabric design can provide full bisection bandwidth, minimize latency, and enable 
                scalability to thousands of nodes. Poor design leads to oversubscription, congestion, and performance 
                bottlenecks. Effective design ensures optimal performance for AI workloads.
            </div>

            <div class="mermaid">
                mindmap
                  root((InfiniBand Fabric Design))
                    Topology Design
                      Fat-Tree Topology
                      Torus Topology
                      Dragonfly+ Topology
                    Switch Placement
                      Leaf Switches
                      Spine Switches
                      Switch Selection
                    Routing Optimization
                      LID Assignment
                      Routing Tables
                      Path Selection
                    Scalability
                      Growth Planning
                      Upgrade Paths
                      Future-Proofing
            </div>
        </section>

        <section id="topology-design" class="section">
            <h2>Topology Design</h2>
            <p>
                Select appropriate InfiniBand topology based on cluster size, bandwidth requirements, and cost 
                constraints. Topology choice impacts performance, scalability, and cost.
            </p>

            <div class="design-card">
                <h3>Fat-Tree Topology</h3>
                <p>Fat-tree provides full bisection bandwidth:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Full Bandwidth:</strong> No oversubscription, full bandwidth between any nodes</li>
                    <li><strong>Scalability:</strong> Scales to large clusters (thousands of nodes)</li>
                    <li><strong>Cost:</strong> Higher cost due to more switches</li>
                    <li><strong>Use Case:</strong> All-to-all communication, high bandwidth requirements</li>
                </ul>

                <div class="mermaid">
                    graph TD
                        A[Servers] --> B[Leaf Switches]
                        B --> C[Spine Switches]
                        C --> D[Full Bisection Bandwidth]
                        B --> E[Multiple Paths]
                        C --> E
                        E --> F[No Oversubscription]
                        
                        style A fill:#0D47A1
                        style D fill:#4CAF50
                        style F fill:#81C784
                    </div>
            </div>

            <div class="design-card">
                <h3>Torus Topology</h3>
                <p>Torus provides cost-effective scaling:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Cost Effective:</strong> Fewer switches than fat-tree</li>
                    <li><strong>Scalability:</strong> Scales well for large clusters</li>
                    <li><strong>Oversubscription:</strong> Some oversubscription possible</li>
                    <li><strong>Use Case:</strong> Large clusters with cost constraints</li>
                </ul>
            </div>

            <div class="design-card">
                <h3>Dragonfly+ Topology</h3>
                <p>Dragonfly+ optimizes for cost and performance:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Cost Optimized:</strong> Fewer switches than fat-tree</li>
                    <li><strong>Performance:</strong> Good performance for many workloads</li>
                    <li><strong>Scalability:</strong> Scales to very large clusters</li>
                    <li><strong>Use Case:</strong> Large-scale clusters</li>
                </ul>
            </div>
        </section>

        <section id="switch-placement" class="section">
            <h2>Switch Placement</h2>
            <p>
                Plan switch placement to optimize performance and minimize costs. Switch placement affects bandwidth, 
                latency, and scalability.
            </p>

            <div class="concept-card">
                <h3>Leaf Switch Placement</h3>
                <p>Place leaf switches for optimal connectivity:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Rack-Level:</strong> One or more leaf switches per rack</li>
                    <li><strong>Port Density:</strong> Match switch ports to rack servers</li>
                    <li><strong>Uplink Capacity:</strong> Ensure sufficient uplink bandwidth</li>
                    <li><strong>Redundancy:</strong> Consider redundant leaf switches</li>
                </ul>
            </div>

            <div class="concept-card">
                <h3>Spine Switch Placement</h3>
                <p>Place spine switches for fabric connectivity:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Central Location:</strong> Central placement for optimal paths</li>
                    <li><strong>Uplink Capacity:</strong> Sufficient capacity for all leaf switches</li>
                    <li><strong>Redundancy:</strong> Multiple spine switches for redundancy</li>
                    <li><strong>Scalability:</strong> Plan for spine expansion</li>
                </ul>
            </div>
        </section>

        <section id="routing-optimization" class="section">
            <h2>Routing Optimization</h2>
            <p>
                Optimize InfiniBand routing for optimal path selection and performance. Routing optimization includes 
                LID assignment, routing table configuration, and path selection.
            </p>

            <div class="design-card">
                <h3>LID Assignment</h3>
                <p>Assign LIDs (Local Identifiers) for optimal routing:</p>
                
                <p style="margin-top: 20px;"><strong>LID Assignment Strategy:</strong></p>
                <ul style="margin-top: 10px; padding-left: 20px; line-height: 2;">
                    <li>Assign LIDs based on topology</li>
                    <li>Group related nodes with consecutive LIDs</li>
                    <li>Optimize for routing efficiency</li>
                    <li>Consider switch placement</li>
                </ul>

                <p style="margin-top: 20px;"><strong>Check LID Assignment:</strong></p>
                <div class="command-box">
# Check LID assignment
ibstat [device]

# Check LID routing
ibroute [device]

# View LID map
ibnetdiscover | grep LID
                </div>
            </div>

            <div class="design-card">
                <h3>Routing Table Configuration</h3>
                <p>Configure routing tables for optimal paths:</p>
                
                <p style="margin-top: 20px;"><strong>Routing Configuration:</strong></p>
                <div class="command-box">
# Check routing tables
ibroute [device]

# View fabric routing
ibnetdiscover

# Check routing performance
ibqueryerrors
                </div>
            </div>

            <div class="mermaid">
                flowchart TD
                    A[Fabric Design] --> B[Select Topology]
                    B --> C[Plan Switch Placement]
                    C --> D[Assign LIDs]
                    D --> E[Configure Routing]
                    E --> F[Optimize Paths]
                    F --> G[Test Fabric]
                    G --> H{Fabric OK?}
                    H -->|No| B
                    H -->|Yes| I[Deploy Fabric]
                    
                    style A fill:#0D47A1
                    style I fill:#4CAF50
                    style H fill:#FF9800
                </div>
        </section>

        <section id="scalability" class="section">
            <h2>Fabric Scalability</h2>
            <p>
                Design fabric for scalability to accommodate growth. Scalability planning ensures fabric can grow 
                without major redesign.
            </p>

            <div class="concept-card">
                <h3>Growth Planning</h3>
                <p>Plan for fabric growth:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Initial Capacity:</strong> Plan for initial cluster size</li>
                    <li><strong>Growth Projections:</strong> Estimate future growth</li>
                    <li><strong>Expansion Path:</strong> Plan for adding switches and nodes</li>
                    <li><strong>Bandwidth Growth:</strong> Plan for increased bandwidth needs</li>
                </ul>
            </div>

            <div class="concept-card">
                <h3>Upgrade Paths</h3>
                <p>Plan upgrade paths for fabric evolution:</p>
                
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Switch Upgrades:</strong> Upgrade switches for higher capacity</li>
                    <li><strong>Link Upgrades:</strong> Upgrade link speeds (HDR to NDR)</li>
                    <li><strong>Topology Evolution:</strong> Evolve topology as needed</li>
                    <li><strong>Technology Adoption:</strong> Adopt new InfiniBand technologies</li>
                </ul>
            </div>
        </section>

        <section id="best-practices" class="section">
            <h2>Fabric Design Best Practices</h2>
            <p>
                Follow best practices for effective InfiniBand fabric design.
            </p>

            <div class="concept-card">
                <h3>Design Best Practices</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li>Select topology based on requirements</li>
                    <li>Plan switch placement carefully</li>
                    <li>Optimize LID assignment</li>
                    <li>Configure routing for optimal paths</li>
                    <li>Plan for scalability</li>
                    <li>Design for redundancy</li>
                </ul>
            </div>

            <div class="example-box">
                <strong>Fabric Design Checklist:</strong>
                1. Analyze bandwidth requirements<br>
                2. Select appropriate topology<br>
                3. Plan switch placement<br>
                4. Design LID assignment<br>
                5. Configure routing<br>
                6. Plan for scalability<br>
                7. Design for redundancy<br>
                8. Test fabric design<br>
                9. Document design decisions<br>
                10. Plan upgrade paths
            </div>
        </section>
            </main>

            </div>
</div>

    <footer>
        <p>InfiniBand Fabric Design | Designing High-Performance InfiniBand Networks</p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
        
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetSection = document.querySelector(targetId);
                
                document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                this.classList.add('active');
                
                targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' }
);
            });
        });

        window.addEventListener('scroll', () => {
            const sections = document.querySelectorAll('.section');
            const navLinks = document.querySelectorAll('.nav-link');
            
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                const sectionHeight = section.clientHeight;
                if (window.pageYOffset >= sectionTop - 100) {
                    current = section.getAttribute('id');
                }

            });

            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
