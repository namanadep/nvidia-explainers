<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>57. DPU Network Interfaces: PFs, VFs, and SFs</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    <style>
* { margin: 0; padding: 0; box-sizing: border-box; }
:root {
    --primary-color: #5E35B1;
    --secondary-color: #7E57C2;
    --accent-color: #9575CD;
    --bg-color: #EDE7F6;
    --card-bg: #FFFFFF;
    --text-color: #1A1A1A;
    --border-color: #B39DDB;
    --shadow: 0 2px 8px rgba(94, 53, 177, 0.1);
}
body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
    background: var(--bg-color);
    color: var(--text-color);
    line-height: 1.6;
}
header {
    text-align: center;
    padding: 50px 40px;
    background: linear-gradient(135deg, #5E35B1, #7E57C2);
    color: white;
}
header h1 {
    font-size: 2.5rem;
    font-weight: 700;
    margin-bottom: 12px;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.2);
}
.subtitle {
    font-size: 1.2rem;
    opacity: 0.95;
    font-weight: 300;
}
.author-credit {
    font-size: 1rem;
    font-weight: 600;
    margin-top: 15px;
    padding: 8px 20px;
    background: rgba(255, 255, 255, 0.25);
    border-radius: 6px;
    display: inline-block;
    text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
    border: 2px solid rgba(255, 255, 255, 0.4);
}

.sidebar-wrapper {
    display: flex;
    min-height: calc(100vh - 200px);
}
.nav-menu {
    width: 280px;
    min-width: 280px;
    background: #80DEEA;
    border-right: 2px solid var(--border-color);
    padding: 20px 0;
    position: sticky;
    top: 0;
    height: calc(100vh - 200px);
    overflow-y: auto;
    display: flex;
    flex-direction: column;
    gap: 4px;
}
.nav-link {
    color: var(--text-color);
    text-decoration: none;
    padding: 12px 20px;
    margin: 0 10px;
    border-radius: 6px;
    transition: all 0.2s ease;
    font-weight: 500;
    display: block;
}
.nav-link:hover, .nav-link.active {
    background: var(--primary-color);
    color: white;
}
.main-content-wrapper {
    flex: 1;
    width: calc(100% - 280px);
    min-width: 0;
}

.section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
.section h2 {
    font-size: 2.2rem;
    margin-bottom: 20px;
    color: var(--primary-color);
    border-bottom: 3px solid var(--primary-color);
    padding-bottom: 10px;
}
.interface-card {
    background: var(--card-bg);
    padding: 25px;
    border-radius: 12px;
    border: 2px solid var(--border-color);
    margin: 20px 0;
    box-shadow: var(--shadow);
}
.interface-card h3 {
    color: var(--primary-color);
    margin-bottom: 15px;
    font-size: 1.4rem;
}
.comparison-table {
    width: 100%;
    border-collapse: collapse;
    margin: 25px 0;
    background: white;
    border-radius: 12px;
    overflow: hidden;
    box-shadow: var(--shadow);
}
.comparison-table th,
.comparison-table td {
    padding: 15px 20px;
    text-align: left;
    border-bottom: 1px solid var(--border-color);
}
.comparison-table th {
    background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
    color: white;
    font-weight: 600;
}
.comparison-table tr:hover {
    background: var(--bg-color);
}
.mermaid { margin: 30px 0; text-align: center; }
.example-box {
    background: linear-gradient(135deg, #EDE7F6, #D1C4E9);
    border-left: 5px solid var(--primary-color);
    padding: 20px 25px;
    margin: 20px 0;
    border-radius: 8px;
}
.example-box strong {
    color: var(--primary-color);
    display: block;
    margin-bottom: 10px;
    font-size: 1.1rem;
}
footer {
    text-align: center;
    padding: 40px;
    background: #B39DDB;
    border-top: 2px solid var(--border-color);
    color: var(--text-color);
}
@media (max-width: 768px) {
    header h1 { font-size: 2rem; }
    
    .nav-menu {
        width: 100%;
        min-width: 100%;
        height: auto;
        position: relative;
        flex-direction: row;
        flex-wrap: wrap;
        padding: 10px;
        border-right: none;
        border-bottom: 2px solid var(--border-color);
    }
    .nav-link {
        padding: 8px 15px;
        margin: 4px;
    }
    
    .section { padding: 25px 20px; }
}
    .section {
    padding: 40px;
    min-height: calc(100vh - 200px);
    border-bottom: 1px solid var(--border-color);
    max-width: 100%;
}
    </style>
</head>
<body>
    <header>
        <h1>57. DPU Network Interfaces</h1>
        <p class="subtitle">PFs, VFs, and SFs: Understanding SR-IOV and Interface Management</p>
        <p class="author-credit">Explained by Naman Adep</p>
    </header>

    <div class="sidebar-wrapper">
    <nav class="nav-menu">
        <a href="#overview" class="nav-link active">Overview</a>
        <a href="#physical-functions" class="nav-link">Physical Functions</a>
        <a href="#virtual-functions" class="nav-link">Virtual Functions</a>
        <a href="#sub-functions" class="nav-link">Sub Functions</a>
        <a href="#management" class="nav-link">Management</a>
    </nav>
    <div class="main-content-wrapper">
        <main>
        <section id="overview" class="section">
            <h2>DPU Network Interfaces Overview</h2>
            <p>
                DPU network interfaces use SR-IOV (Single Root I/O Virtualization) technology to create multiple 
                virtual network interfaces from physical network ports. These interfaces are categorized as Physical 
                Functions (PFs), Virtual Functions (VFs), and Sub Functions (SFs), each serving different purposes 
                in network virtualization and resource sharing. Understanding these interface types is essential for 
                configuring DPU networking, managing network resources, and optimizing network performance in 
                virtualized and containerized environments.
            </p>

            <div class="mermaid">
                graph TD
                    A[Physical Port] --> B[Physical Function<br/>PF]
                    B --> C[Virtual Function 1<br/>VF]
                    B --> D[Virtual Function 2<br/>VF]
                    B --> E[Virtual Function N<br/>VF]
                    
                    C --> F[Sub Function 1<br/>SF]
                    C --> G[Sub Function 2<br/>SF]
                    
                    style A fill:#5E35B1
                    style B fill:#7E57C2
                    style C fill:#9575CD
                    style F fill:#B39DDB
            </div>

            <div class="example-box">
                <strong>Interface Hierarchy:</strong>
                PFs, VFs, and SFs form a hierarchical network interface structure: PF is the physical function 
                associated with a physical port, VFs are virtual functions created from PFs, and SFs are sub-functions 
                created from VFs. Each level provides different capabilities and isolation levels, enabling flexible 
                network resource allocation and management for multi-tenant environments.
            </div>

            <div class="mermaid">
                mindmap
                  root((DPU Network Interfaces))
                    Physical Functions
                      PF
                        Physical Port
                        Port Management
                    Virtual Functions
                      VF
                        Created from PF
                        VM Networking
                    Sub-Functions
                      SF
                        Created from VF
                        Container Networking
                    Use Cases
                      Port Management
                      VM Networking
                      Container Deployments
                      Kubernetes Pods
            </div>
        </section>

        <section id="physical-functions" class="section">
            <h2>Physical Functions (PFs)</h2>
            <p>
                Physical Functions are the primary interfaces associated with physical network ports. PFs have full 
                control over the physical port and can create and manage Virtual Functions. PFs are typically used 
                for management and control operations.
            </p>

            <div class="mermaid">
                flowchart TD
                    A[PF Characteristics] --> B[Physical Port<br/>Direct Association]
                    A --> C[Full Control<br/>Port Configuration]
                    A --> D[VF Creation<br/>Create & Manage VFs]
                    A --> E[Management<br/>Port Management]
                    A --> F[Configuration<br/>Port Settings]
                    
                    style A fill:#5E35B1
                    style B fill:#7E57C2
                    style C fill:#9575CD
                    style D fill:#B39DDB
                    style E fill:#CE93D8
                    style F fill:#E1BEE7
                </div>

            <div class="interface-card">
                <h3>PF Use Cases</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Port Management:</strong> Managing physical port</li>
                    <li><strong>VF Management:</strong> Creating and configuring VFs</li>
                    <li><strong>Configuration:</strong> Port-level configuration</li>
                    <li><strong>Monitoring:</strong> Port monitoring and statistics</li>
                </ul>
            </div>

            <div class="mermaid">
                flowchart TD
                    A[PF Identification] --> B[Port Number<br/>Specific Port]
                    A --> C[Device Name<br/>mlx5_0, etc.]
                    A --> D[PCI Address<br/>PCI Device Address]
                    
                    style A fill:#5E35B1
                    style B fill:#7E57C2
                    style C fill:#9575CD
                    style D fill:#B39DDB
                </div>
        </section>

        <section id="virtual-functions" class="section">
            <h2>Virtual Functions (VFs)</h2>
            <p>
                Virtual Functions are virtual interfaces created from Physical Functions. VFs share the physical 
                port's resources but operate independently, each with its own MAC address and configuration. VFs 
                enable network resource sharing and are commonly used in virtualized environments.
            </p>

            <div class="mermaid">
                graph LR
                    A[PF<br/>Physical Port] --> B[VF 1<br/>MAC 1]
                    A --> C[VF 2<br/>MAC 2]
                    A --> D[VF 3<br/>MAC 3]
                    
                    B --> E[VM/Container 1]
                    C --> F[VM/Container 2]
                    D --> G[VM/Container 3]
                    
                    style A fill:#5E35B1
                    style B fill:#7E57C2
                    style C fill:#9575CD
                    style D fill:#B39DDB
            </div>

            <div class="interface-card">
                <h3>VF Characteristics</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Virtual Interface:</strong> Virtual interface, not physical</li>
                    <li><strong>Independent MAC:</strong> Each VF has own MAC address</li>
                    <li><strong>Resource Sharing:</strong> Shares physical port resources</li>
                    <li><strong>Isolation:</strong> Isolated from other VFs</li>
                    <li><strong>Performance:</strong> Near-native performance</li>
                </ul>
            </div>

            <div class="mermaid">
                flowchart LR
                    A[VF Use Cases] --> B[VM Networking<br/>VM Interfaces]
                    A --> C[Container Networking<br/>Container Interfaces]
                    A --> D[Resource Sharing<br/>Share Port]
                    A --> E[Isolation<br/>Isolate Traffic]
                    
                    style A fill:#5E35B1
                    style B fill:#7E57C2
                    style C fill:#9575CD
                    style D fill:#B39DDB
                    style E fill:#CE93D8
                </div>

            <div class="interface-card">
                <h3>VF Creation</h3>
                <p>VFs are created from PFs:</p>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>SR-IOV Enabled:</strong> SR-IOV must be enabled</li>
                    <li><strong>PF Management:</strong> Created via PF management</li>
                    <li><strong>Configuration:</strong> Configured independently</li>
                    <li><strong>Limits:</strong> Limited by hardware capabilities</li>
                </ul>
            </div>
        </section>

        <section id="sub-functions" class="section">
            <h2>Sub Functions (SFs)</h2>
            <p>
                Sub Functions are lightweight virtual interfaces created from Virtual Functions. SFs provide even 
                finer-grained network resource allocation, enabling more efficient resource utilization and better 
                scalability for containerized workloads.
            </p>

            <div class="interface-card">
                <h3>SF Characteristics</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Lightweight:</strong> Lighter weight than VFs</li>
                    <li><strong>Scalability:</strong> Enable higher scalability</li>
                    <li><strong>Efficiency:</strong> More efficient resource usage</li>
                    <li><strong>Container-Optimized:</strong> Optimized for containers</li>
                    <li><strong>Kubernetes Integration:</strong> Well-integrated with Kubernetes</li>
                </ul>
            </div>

            <div class="interface-card">
                <h3>SF Use Cases</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Container Networking:</strong> Network interfaces for containers</li>
                    <li><strong>Kubernetes Pods:</strong> Network interfaces for pods</li>
                    <li><strong>High Density:</strong> High-density container deployments</li>
                    <li><strong>Resource Efficiency:</strong> Efficient resource utilization</li>
                </ul>
            </div>

            <div class="interface-card">
                <h3>SF Advantages</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Higher Density:</strong> Support more interfaces per port</li>
                    <li><strong>Lower Overhead:</strong> Lower overhead than VFs</li>
                    <li><strong>Better Scaling:</strong> Better scaling characteristics</li>
                    <li><strong>Container Native:</strong> Native container support</li>
                </ul>
            </div>
        </section>

        <section id="management" class="section">
            <h2>Interface Management</h2>
            <p>
                Managing PFs, VFs, and SFs involves creating, configuring, and monitoring these interfaces. 
                Proper management ensures optimal network resource utilization and performance.
            </p>

            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Interface Type</th>
                        <th>Creation</th>
                        <th>Use Case</th>
                        <th>Scalability</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Physical Function (PF)</strong></td>
                        <td>Hardware (physical port)</td>
                        <td>Port management</td>
                        <td>1 per port</td>
                    </tr>
                    <tr>
                        <td><strong>Virtual Function (VF)</strong></td>
                        <td>Created from PF</td>
                        <td>VM/container networking</td>
                        <td>10s-100s per PF</td>
                    </tr>
                    <tr>
                        <td><strong>Sub Function (SF)</strong></td>
                        <td>Created from VF</td>
                        <td>Container networking</td>
                        <td>100s-1000s per VF</td>
                    </tr>
                </tbody>
            </table>

            <div class="interface-card">
                <h3>SR-IOV Configuration</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Enable SR-IOV:</strong> Enable SR-IOV on PF</li>
                    <li><strong>Create VFs:</strong> Create desired number of VFs</li>
                    <li><strong>Configure VFs:</strong> Configure VF settings</li>
                    <li><strong>Assign VFs:</strong> Assign VFs to VMs/containers</li>
                </ul>
            </div>

            <div class="interface-card">
                <h3>Kernel Representors Model</h3>
                <p>Kernel representors enable host management of VFs/SFs:</p>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Representor Interface:</strong> Host-side interface</li>
                    <li><strong>VF/SF Mapping:</strong> Maps to VF/SF</li>
                    <li><strong>Management:</strong> Enables host management</li>
                    <li><strong>OVS Integration:</strong> Integration with OVS</li>
                </ul>
            </div>

            <div class="interface-card">
                <h3>Best Practices</h3>
                <ul style="margin-top: 15px; padding-left: 20px; line-height: 2;">
                    <li><strong>Plan Allocation:</strong> Plan VF/SF allocation based on needs</li>
                    <li><strong>Monitor Usage:</strong> Monitor interface usage</li>
                    <li><strong>Optimize Configuration:</strong> Optimize for workload patterns</li>
                    <li><strong>Document Configuration:</strong> Document interface configuration</li>
                </ul>
            </div>

            <div class="example-box">
                <strong>Interface Selection:</strong>
                Use PFs for port management. Use VFs for VM networking and moderate-scale container deployments. 
                Use SFs for high-density container deployments and Kubernetes pods. The choice depends on scale 
                requirements, workload characteristics, and resource efficiency needs.
            </div>
        </section>
            </main>

            </div>
</div>

    <footer>
        <p>DPU Network Interfaces Guide | PFs, VFs, and SFs</p>
    </footer>

    <script>
        mermaid.initialize({ startOnLoad: true, theme: 'default' });
        
        document.querySelectorAll('.nav-link').forEach(link => {
            link.addEventListener('click', function(e) {
                e.preventDefault();
                const targetId = this.getAttribute('href');
                const targetSection = document.querySelector(targetId);
                if (targetSection) {
                    targetSection.scrollIntoView({ behavior: 'smooth' }
);
                    document.querySelectorAll('.nav-link').forEach(l => l.classList.remove('active'));
                    this.classList.add('active');
                }

            });
        });

        const sections = document.querySelectorAll('.section');
        const navLinks = document.querySelectorAll('.nav-link');
        
        window.addEventListener('scroll', () => {
            let current = '';
            sections.forEach(section => {
                const sectionTop = section.offsetTop;
                if (pageYOffset >= sectionTop - 200) {
                    current = section.getAttribute('id');
                }

            });
            
            navLinks.forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${current}`) {
                    link.classList.add('active');
                }
            });
        });
    </script>
</body>
</html>
